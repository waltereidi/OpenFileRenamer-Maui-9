@namespace Presentation.Maui.Components.Pages

@page "/DataPreview"
@using ApplicationService.DAO
@using ApplicationService.Interfaces
@using Presentation.Maui.Components.PreviewOptions
@using Presentation.Maui.Components.Shared
@using Presentation.Maui.Service

<div class="form-group my-3">
    <label >Rename Preview</label>
    <select class="form-control" @onchange="PreviewSelectionChanged">
        <option value="0">NumberedSequence</option>
        <option value="1">Append</option>
        <option value="2">Pattern</option>
    </select>
</div>

<div class="my-3">
@switch(PreviewOption)
{
    case 0:
            <NumberedSequencePreviewer CallBack="PreviewFormChanged"></NumberedSequencePreviewer>
        ; break;
    case 1:
            <AppendPreviewer CallBack="PreviewFormChanged"></AppendPreviewer>
        ; break;
        case 2:
            <PatternPreviewer CallBack="PreviewFormChanged"></PatternPreviewer>
        ; break;
}
</div>

    <DataTableModelPreviewer DataTableFiles="TablePreview"></DataTableModelPreviewer>

@code {


    private int PreviewOption { get; set; }

    private void PreviewSelectionChanged(ChangeEventArgs e)
        => PreviewOption = int.Parse(e.Value.ToString());

    private IOperationContract OperationContract { get; set; }

    private ITablePreview TablePreview { get; set; }
  
    protected override void OnAfterRender(bool firstRender)
        => TablePreview = new TablePreviewDAO(DirectoryManagerService._dir, OperationContract);

    private void PreviewFormChanged(IOperationContract contract )
        => OperationContract = contract;
}
